# frozen_string_literal: true

require 'rails_helper'

RSpec.describe SocialData::Client, :vcr do
  let(:user) { double('User', identity: double('Identity', uid: '1691930809756991488')) }
  let(:client) { described_class.new(user) }

  describe '#fetch_user_tweets' do
    it 'fetches new tweets from the API' do
      tweets = client.fetch_user_tweets
      expect(tweets).to eq(fetch_user_tweets_response_body)
    end
  end

  describe '#fetch_user_with_metrics' do
    it 'fetches user data from the API' do
      user_data = client.fetch_user_with_metrics
      expect(user_data).to eq(fetch_user_with_metrics_response_body)
    end
  end

  describe '#fetch_tweets_by_ids' do
    context 'when the tweet IDs are a mixture of valid and invalid IDs' do
      let(:tweet_ids) { ['1758983678515085403', '1740577614476321069'] }

      it 'fetches valid tweets by their IDs from the API' do
        response = client.fetch_tweets_by_ids(tweet_ids)
        expect(response).to eq(fetch_tweets_by_ids_response_body)
      end
    end
  end

  let(:fetch_tweets_by_ids_response_body) do
    [{"tweet_created_at"=>"2024-02-17T22:36:03.000000Z", "id"=>1758983678515085403, "id_str"=>"1758983678515085403", "text"=>nil, "full_text"=>"test", "source"=>"<a href=\"https://mobile.twitter.com\" rel=\"nofollow\">Twitter Web App</a>", "truncated"=>false, "in_reply_to_status_id"=>nil, "in_reply_to_status_id_str"=>nil, "in_reply_to_user_id"=>nil, "in_reply_to_user_id_str"=>nil, "in_reply_to_screen_name"=>nil, "user"=>{"id"=>1691930809756991488, "id_str"=>"1691930809756991488", "name"=>"Topher", "screen_name"=>"TopherToy", "location"=>"", "url"=>nil, "description"=>"Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq", "protected"=>false, "verified"=>false, "followers_count"=>3, "friends_count"=>16, "listed_count"=>0, "favourites_count"=>11, "statuses_count"=>19, "created_at"=>"2023-08-16T21:52:25.000000Z", "profile_banner_url"=>"https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482", "profile_image_url_https"=>"https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg", "can_dm"=>false}, "quoted_status_id"=>nil, "quoted_status_id_str"=>nil, "is_quote_status"=>false, "quoted_status"=>nil, "retweeted_status"=>nil, "quote_count"=>0, "reply_count"=>0, "retweet_count"=>0, "favorite_count"=>0, "lang"=>"en", "entities"=>{"user_mentions"=>[], "urls"=>[], "hashtags"=>[], "symbols"=>[]}, "views_count"=>17, "bookmark_count"=>0}, {"tweet_created_at"=>"2023-12-29T03:36:56.000000Z", "id"=>1740577614476321069, "id_str"=>"1740577614476321069", "text"=>nil, "full_text"=>"test2", "source"=>"<a href=\"https://mobile.twitter.com\" rel=\"nofollow\">Twitter Web App</a>", "truncated"=>false, "in_reply_to_status_id"=>nil, "in_reply_to_status_id_str"=>nil, "in_reply_to_user_id"=>nil, "in_reply_to_user_id_str"=>nil, "in_reply_to_screen_name"=>nil, "user"=>{"id"=>1691930809756991488, "id_str"=>"1691930809756991488", "name"=>"Topher", "screen_name"=>"TopherToy", "location"=>"", "url"=>nil, "description"=>"Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq", "protected"=>false, "verified"=>false, "followers_count"=>3, "friends_count"=>16, "listed_count"=>0, "favourites_count"=>11, "statuses_count"=>19, "created_at"=>"2023-08-16T21:52:25.000000Z", "profile_banner_url"=>"https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482", "profile_image_url_https"=>"https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg", "can_dm"=>false}, "quoted_status_id"=>nil, "quoted_status_id_str"=>nil, "is_quote_status"=>false, "quoted_status"=>nil, "retweeted_status"=>nil, "quote_count"=>0, "reply_count"=>0, "retweet_count"=>0, "favorite_count"=>0, "lang"=>"en", "entities"=>{"user_mentions"=>[], "urls"=>[], "hashtags"=>[], "symbols"=>[]}, "views_count"=>8, "bookmark_count"=>0}]
  end

  let(:fetch_user_tweets_response_body) do
    {
      'tweets' => [
        { 'tweet_created_at' => '2024-02-17T22:36:03.000000Z', 'id' => 1_758_983_678_515_085_403,
          'id_str' => '1758983678515085403', 'text' => nil, 'full_text' => 'test', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 0, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 14, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2024-02-06T23:40:46.000000Z', 'id' => 1_755_013_695_040_880_857, 'id_str' => '1755013695040880857', 'text' => nil, 'full_text' => 'RT @loftwah: A little bit of a sneak peak for Echosight. https://t.co/wdg5EP1mEO', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => { 'tweet_created_at' => '2024-02-06T09:33:32.000000Z', 'id' => 1_754_800_481_510_265_229, 'id_str' => '1754800481510265229', 'text' => nil, 'full_text' => 'A little bit of a sneak peak for Echosight. https://t.co/wdg5EP1mEO', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_192_091_185, 'id_str' => '1192091185', 'name' => 'Loftwah', 'screen_name' => 'loftwah', 'location' => 'Earth', 'url' => 'https://biodrop.io/loftwah', 'description' => 'Revolutionize Your Social Media Strategy with Echosight | https://t.co/wMI0LubEYS | https://t.co/HLB3aL1R1I | https://t.co/aYAfScUFBU | https://t.co/0Nsgyrjd7y', 'protected' => false, 'verified' => true, 'followers_count' => 6605, 'friends_count' => 4512, 'listed_count' => 39, 'favourites_count' => 143_943, 'statuses_count' => 52_084, 'created_at' => '2013-02-18T05:01:04.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1192091185/1707817030', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1756873036220059648/zc13kjbX_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 0, 'reply_count' => 3, 'retweet_count' => 1, 'favorite_count' => 3, 'lang' => 'en', 'entities' => { 'media' => [{ 'display_url' => 'pic.twitter.com/wdg5EP1mEO', 'expanded_url' => 'https://twitter.com/loftwah/status/1754800481510265229/photo/1', 'id_str' => '1754800451407785984', 'indices' => [44, 67], 'media_key' => '3_1754800451407785984', 'media_url_https' => 'https://pbs.twimg.com/media/GFpNtpXbMAAs9mX.jpg', 'type' => 'photo', 'url' => 'https://t.co/wdg5EP1mEO', 'ext_media_availability' => { 'status' => 'Available' }, 'features' => { 'large' => { 'faces' => [] }, 'medium' => { 'faces' => [] }, 'small' => { 'faces' => [] }, 'orig' => { 'faces' => [] } }, 'sizes' => { 'large' => { 'h' => 922, 'w' => 1920, 'resize' => 'fit' }, 'medium' => { 'h' => 576, 'w' => 1200, 'resize' => 'fit' }, 'small' => { 'h' => 327, 'w' => 680, 'resize' => 'fit' }, 'thumb' => { 'h' => 150, 'w' => 150, 'resize' => 'crop' } }, 'original_info' => { 'height' => 922, 'width' => 1920, 'focus_rects' => [{ 'x' => 0, 'y' => 0, 'w' => 1646, 'h' => 922 }, { 'x' => 0, 'y' => 0, 'w' => 922, 'h' => 922 }, { 'x' => 0, 'y' => 0, 'w' => 809, 'h' => 922 }, { 'x' => 9, 'y' => 0, 'w' => 461, 'h' => 922 }, { 'x' => 0, 'y' => 0, 'w' => 1920, 'h' => 922 }] } }], 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 349, 'bookmark_count' => 0 }, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 1, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'media' => [{ 'display_url' => 'pic.twitter.com/wdg5EP1mEO', 'expanded_url' => 'https://twitter.com/loftwah/status/1754800481510265229/photo/1', 'id_str' => '1754800451407785984', 'indices' => [57, 80], 'media_key' => '3_1754800451407785984', 'media_url_https' => 'https://pbs.twimg.com/media/GFpNtpXbMAAs9mX.jpg', 'source_status_id_str' => '1754800481510265229', 'source_user_id_str' => '1192091185', 'type' => 'photo', 'url' => 'https://t.co/wdg5EP1mEO', 'ext_media_availability' => { 'status' => 'Available' }, 'features' => { 'large' => { 'faces' => [] }, 'medium' => { 'faces' => [] }, 'small' => { 'faces' => [] }, 'orig' => { 'faces' => [] } }, 'sizes' => { 'large' => { 'h' => 922, 'w' => 1920, 'resize' => 'fit' }, 'medium' => { 'h' => 576, 'w' => 1200, 'resize' => 'fit' }, 'small' => { 'h' => 327, 'w' => 680, 'resize' => 'fit' }, 'thumb' => { 'h' => 150, 'w' => 150, 'resize' => 'crop' } }, 'original_info' => { 'height' => 922, 'width' => 1920, 'focus_rects' => [{ 'x' => 0, 'y' => 0, 'w' => 1646, 'h' => 922 }, { 'x' => 0, 'y' => 0, 'w' => 922, 'h' => 922 }, { 'x' => 0, 'y' => 0, 'w' => 809, 'h' => 922 }, { 'x' => 9, 'y' => 0, 'w' => 461, 'h' => 922 }, { 'x' => 0, 'y' => 0, 'w' => 1920, 'h' => 922 }] } }], 'user_mentions' => [{ 'id_str' => '1192091185', 'name' => 'Loftwah', 'screen_name' => 'loftwah', 'indices' => [3, 11] }], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => nil, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2024-01-23T00:11:45.000000Z', 'id' => 1_749_585_674_108_653_948, 'id_str' => '1749585674108653948', 'text' => nil, 'full_text' => 'RT @IroncladDev: Rickroll someone if they disable Javascript in their browser https://t.co/luVmMFUJDH', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => { 'tweet_created_at' => '2024-01-22T18:00:01.000000Z', 'id' => 1_749_492_125_471_838_615, 'id_str' => '1749492125471838615', 'text' => nil, 'full_text' => 'Rickroll someone if they disable Javascript in their browser https://t.co/luVmMFUJDH', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_493_324_304_896_909_316, 'id_str' => '1493324304896909316', 'name' => 'IroncladDev ðŸ”©', 'screen_name' => 'IroncladDev', 'location' => 'Whitewright, TX, USA', 'url' => 'https://connerow.dev', 'description' => "18 â€¢ Texan â€¢ Fullstack Web Dev â€¢\n\nCan center a div and exit vim â€¢ \n\nBuilding @VultangAI", 'protected' => false, 'verified' => true, 'followers_count' => 3769, 'friends_count' => 353, 'listed_count' => 46, 'favourites_count' => 16_242, 'statuses_count' => 10_510, 'created_at' => '2022-02-14T20:41:07.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1493324304896909316/1690894459', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1587110787277103104/3jOe4QcP_normal.png', 'can_dm' => true }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 10, 'reply_count' => 21, 'retweet_count' => 68, 'favorite_count' => 885, 'lang' => 'en', 'entities' => { 'media' => [{ 'display_url' => 'pic.twitter.com/luVmMFUJDH', 'expanded_url' => 'https://twitter.com/IroncladDev/status/1749492125471838615/photo/1', 'id_str' => '1749448459902402560', 'indices' => [61, 84], 'media_key' => '3_1749448459902402560', 'media_url_https' => 'https://pbs.twimg.com/media/GEdKGvVWQAAKnm0.png', 'type' => 'photo', 'url' => 'https://t.co/luVmMFUJDH', 'ext_media_availability' => { 'status' => 'Available' }, 'features' => { 'large' => { 'faces' => [] }, 'medium' => { 'faces' => [] }, 'small' => { 'faces' => [] }, 'orig' => { 'faces' => [] } }, 'sizes' => { 'large' => { 'h' => 297, 'w' => 680, 'resize' => 'fit' }, 'medium' => { 'h' => 297, 'w' => 680, 'resize' => 'fit' }, 'small' => { 'h' => 297, 'w' => 680, 'resize' => 'fit' }, 'thumb' => { 'h' => 150, 'w' => 150, 'resize' => 'crop' } }, 'original_info' => { 'height' => 297, 'width' => 680, 'focus_rects' => [{ 'x' => 0, 'y' => 0, 'w' => 530, 'h' => 297 }, { 'x' => 0, 'y' => 0, 'w' => 297, 'h' => 297 }, { 'x' => 0, 'y' => 0, 'w' => 261, 'h' => 297 }, { 'x' => 44, 'y' => 0, 'w' => 149, 'h' => 297 }, { 'x' => 0, 'y' => 0, 'w' => 680, 'h' => 297 }] } }], 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 59_396, 'bookmark_count' => 204 }, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 68, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'media' => [{ 'display_url' => 'pic.twitter.com/luVmMFUJDH', 'expanded_url' => 'https://twitter.com/IroncladDev/status/1749492125471838615/photo/1', 'id_str' => '1749448459902402560', 'indices' => [78, 101], 'media_key' => '3_1749448459902402560', 'media_url_https' => 'https://pbs.twimg.com/media/GEdKGvVWQAAKnm0.png', 'source_status_id_str' => '1749492125471838615', 'source_user_id_str' => '1493324304896909316', 'type' => 'photo', 'url' => 'https://t.co/luVmMFUJDH', 'ext_media_availability' => { 'status' => 'Available' }, 'features' => { 'large' => { 'faces' => [] }, 'medium' => { 'faces' => [] }, 'small' => { 'faces' => [] }, 'orig' => { 'faces' => [] } }, 'sizes' => { 'large' => { 'h' => 297, 'w' => 680, 'resize' => 'fit' }, 'medium' => { 'h' => 297, 'w' => 680, 'resize' => 'fit' }, 'small' => { 'h' => 297, 'w' => 680, 'resize' => 'fit' }, 'thumb' => { 'h' => 150, 'w' => 150, 'resize' => 'crop' } }, 'original_info' => { 'height' => 297, 'width' => 680, 'focus_rects' => [{ 'x' => 0, 'y' => 0, 'w' => 530, 'h' => 297 }, { 'x' => 0, 'y' => 0, 'w' => 297, 'h' => 297 }, { 'x' => 0, 'y' => 0, 'w' => 261, 'h' => 297 }, { 'x' => 44, 'y' => 0, 'w' => 149, 'h' => 297 }, { 'x' => 0, 'y' => 0, 'w' => 680, 'h' => 297 }] } }], 'user_mentions' => [{ 'id_str' => '1493324304896909316', 'name' => 'IroncladDev ðŸ”©', 'screen_name' => 'IroncladDev', 'indices' => [3, 15] }], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => nil, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2024-01-13T13:45:54.000000Z', 'id' => 1_746_166_684_950_655_392, 'id_str' => '1746166684950655392', 'text' => nil, 'full_text' => 'Reflecting on the growth from managing Microsoft domains to cloud computing. Tech sure has come a long way.', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 0, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 9, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2024-01-12T07:35:39.000000Z', 'id' => 1_745_711_119_220_789_313, 'id_str' => '1745711119220789313', 'text' => nil, 'full_text' => 'Remember dial-up internet? Our patience was truly tested back then.', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 0, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 7, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2024-01-04T12:58:56.000000Z', 'id' => 1_742_893_373_521_002_602, 'id_str' => '1742893373521002602', 'text' => nil, 'full_text' => 'Echosight is the future of social media analytics â€” a blend of in-depth insights and public exhibition. Ready to transform your digital presence? Join our waiting list or visit our website to embark on your journey to data-driven success.', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 0, 'reply_count' => 1, 'retweet_count' => 0, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 23, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2024-01-04T12:59:02.000000Z', 'id' => 1_742_893_400_368_812_336, 'id_str' => '1742893400368812336', 'text' => nil, 'full_text' => 'https://t.co/Db93K6YIrq', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => 1_742_893_373_521_002_602, 'in_reply_to_status_id_str' => '1742893373521002602', 'in_reply_to_user_id' => 1_691_930_809_756_991_488, 'in_reply_to_user_id_str' => '1691930809756991488', 'in_reply_to_screen_name' => 'TopherToy', 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 0, 'favorite_count' => 0, 'lang' => 'zxx', 'entities' => { 'user_mentions' => [], 'urls' => [{ 'display_url' => 'echosight.io', 'expanded_url' => 'https://echosight.io', 'url' => 'https://t.co/Db93K6YIrq', 'indices' => [0, 23] }], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 10, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2024-01-04T01:11:16.000000Z', 'id' => 1_742_715_282_936_987_732, 'id_str' => '1742715282936987732', 'text' => nil, 'full_text' => 'RT @loftwah: Imagine building a product where you are the perfect example of what a customer looks like? You canâ€™t lose.', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => { 'tweet_created_at' => '2024-01-04T00:20:47.000000Z', 'id' => 1_742_702_578_310_500_428, 'id_str' => '1742702578310500428', 'text' => nil, 'full_text' => 'Imagine building a product where you are the perfect example of what a customer looks like? You canâ€™t lose.', 'source' => '<a href="http://twitter.com/download/iphone" rel="nofollow">Twitter for iPhone</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_192_091_185, 'id_str' => '1192091185', 'name' => 'Loftwah', 'screen_name' => 'loftwah', 'location' => 'Earth', 'url' => 'https://biodrop.io/loftwah', 'description' => 'Revolutionize Your Social Media Strategy with Echosight | https://t.co/wMI0LubEYS | https://t.co/HLB3aL1R1I | https://t.co/aYAfScUFBU | https://t.co/0Nsgyrjd7y', 'protected' => false, 'verified' => true, 'followers_count' => 6605, 'friends_count' => 4512, 'listed_count' => 39, 'favourites_count' => 143_943, 'statuses_count' => 52_084, 'created_at' => '2013-02-18T05:01:04.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1192091185/1707817030', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1756873036220059648/zc13kjbX_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 0, 'reply_count' => 3, 'retweet_count' => 2, 'favorite_count' => 18, 'lang' => 'en', 'entities' => { 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 860, 'bookmark_count' => 0 }, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 2, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'user_mentions' => [{ 'id_str' => '1192091185', 'name' => 'Loftwah', 'screen_name' => 'loftwah', 'indices' => [3, 11] }], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => nil, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2024-01-03T09:03:24.000000Z', 'id' => 1_742_471_713_001_255_139, 'id_str' => '1742471713001255139', 'text' => nil, 'full_text' => 'AMPLIFY YOUR DIGITAL IMPACT - Track With Echosight', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 1, 'reply_count' => 0, 'retweet_count' => 1, 'favorite_count' => 1, 'lang' => 'en', 'entities' => { 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 346, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2024-01-02T20:43:17.000000Z', 'id' => 1_742_285_457_533_354_011, 'id_str' => '1742285457533354011', 'text' => nil, 'full_text' => "RT @loftwah: Who's up for an interesting year? https://t.co/TbX7PhAwRZ", 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => { 'tweet_created_at' => '2024-01-02T06:10:02.000000Z', 'id' => 1_742_065_695_905_751_170, 'id_str' => '1742065695905751170', 'text' => nil, 'full_text' => "Who's up for an interesting year? https://t.co/TbX7PhAwRZ", 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_192_091_185, 'id_str' => '1192091185', 'name' => 'Loftwah', 'screen_name' => 'loftwah', 'location' => 'Earth', 'url' => 'https://biodrop.io/loftwah', 'description' => 'Revolutionize Your Social Media Strategy with Echosight | https://t.co/wMI0LubEYS | https://t.co/HLB3aL1R1I | https://t.co/aYAfScUFBU | https://t.co/0Nsgyrjd7y', 'protected' => false, 'verified' => true, 'followers_count' => 6605, 'friends_count' => 4512, 'listed_count' => 39, 'favourites_count' => 143_943, 'statuses_count' => 52_084, 'created_at' => '2013-02-18T05:01:04.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1192091185/1707817030', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1756873036220059648/zc13kjbX_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 5, 'reply_count' => 20, 'retweet_count' => 18, 'favorite_count' => 247, 'lang' => 'en', 'entities' => { 'media' => [{ 'display_url' => 'pic.twitter.com/TbX7PhAwRZ', 'expanded_url' => 'https://twitter.com/loftwah/status/1742065695905751170/photo/1', 'id_str' => '1742065668021948416', 'indices' => [34, 57], 'media_key' => '3_1742065668021948416', 'media_url_https' => 'https://pbs.twimg.com/media/GC0PfsXaEAAOyxv.jpg', 'type' => 'photo', 'url' => 'https://t.co/TbX7PhAwRZ', 'ext_media_availability' => { 'status' => 'Available' }, 'features' => { 'large' => { 'faces' => [] }, 'medium' => { 'faces' => [] }, 'small' => { 'faces' => [] }, 'orig' => { 'faces' => [] } }, 'sizes' => { 'large' => { 'h' => 799, 'w' => 1080, 'resize' => 'fit' }, 'medium' => { 'h' => 799, 'w' => 1080, 'resize' => 'fit' }, 'small' => { 'h' => 503, 'w' => 680, 'resize' => 'fit' }, 'thumb' => { 'h' => 150, 'w' => 150, 'resize' => 'crop' } }, 'original_info' => { 'height' => 799, 'width' => 1080, 'focus_rects' => [{ 'x' => 0, 'y' => 0, 'w' => 1080, 'h' => 605 }, { 'x' => 221, 'y' => 0, 'w' => 799, 'h' => 799 }, { 'x' => 270, 'y' => 0, 'w' => 701, 'h' => 799 }, { 'x' => 420, 'y' => 0, 'w' => 400, 'h' => 799 }, { 'x' => 0, 'y' => 0, 'w' => 1080, 'h' => 799 }] } }], 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 13_758, 'bookmark_count' => 5 }, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 18, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'media' => [{ 'display_url' => 'pic.twitter.com/TbX7PhAwRZ', 'expanded_url' => 'https://twitter.com/loftwah/status/1742065695905751170/photo/1', 'id_str' => '1742065668021948416', 'indices' => [47, 70], 'media_key' => '3_1742065668021948416', 'media_url_https' => 'https://pbs.twimg.com/media/GC0PfsXaEAAOyxv.jpg', 'source_status_id_str' => '1742065695905751170', 'source_user_id_str' => '1192091185', 'type' => 'photo', 'url' => 'https://t.co/TbX7PhAwRZ', 'ext_media_availability' => { 'status' => 'Available' }, 'features' => { 'large' => { 'faces' => [] }, 'medium' => { 'faces' => [] }, 'small' => { 'faces' => [] }, 'orig' => { 'faces' => [] } }, 'sizes' => { 'large' => { 'h' => 799, 'w' => 1080, 'resize' => 'fit' }, 'medium' => { 'h' => 799, 'w' => 1080, 'resize' => 'fit' }, 'small' => { 'h' => 503, 'w' => 680, 'resize' => 'fit' }, 'thumb' => { 'h' => 150, 'w' => 150, 'resize' => 'crop' } }, 'original_info' => { 'height' => 799, 'width' => 1080, 'focus_rects' => [{ 'x' => 0, 'y' => 0, 'w' => 1080, 'h' => 605 }, { 'x' => 221, 'y' => 0, 'w' => 799, 'h' => 799 }, { 'x' => 270, 'y' => 0, 'w' => 701, 'h' => 799 }, { 'x' => 420, 'y' => 0, 'w' => 400, 'h' => 799 }, { 'x' => 0, 'y' => 0, 'w' => 1080, 'h' => 799 }] } }], 'user_mentions' => [{ 'id_str' => '1192091185', 'name' => 'Loftwah', 'screen_name' => 'loftwah', 'indices' => [3, 11] }], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => nil, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2023-12-29T03:36:56.000000Z', 'id' => 1_740_577_614_476_321_069, 'id_str' => '1740577614476321069', 'text' => nil, 'full_text' => 'test2', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 0, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 6, 'bookmark_count' => 0 }, { 'tweet_created_at' => '2023-12-28T22:24:31.000000Z', 'id' => 1_740_498_992_587_567_374, 'id_str' => '1740498992587567374', 'text' => nil, 'full_text' => 'test', 'source' => '<a href="https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>', 'truncated' => false, 'in_reply_to_status_id' => nil, 'in_reply_to_status_id_str' => nil, 'in_reply_to_user_id' => nil, 'in_reply_to_user_id_str' => nil, 'in_reply_to_screen_name' => nil, 'user' => { 'id' => 1_691_930_809_756_991_488, 'id_str' => '1691930809756991488', 'name' => 'Topher', 'screen_name' => 'TopherToy', 'location' => '', 'url' => nil, 'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq', 'protected' => false, 'verified' => false, 'followers_count' => 3, 'friends_count' => 16, 'listed_count' => 0, 'favourites_count' => 11, 'statuses_count' => 15, 'created_at' => '2023-08-16T21:52:25.000000Z', 'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482', 'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg', 'can_dm' => false }, 'quoted_status_id' => nil, 'quoted_status_id_str' => nil, 'is_quote_status' => false, 'quoted_status' => nil, 'retweeted_status' => nil, 'quote_count' => 0, 'reply_count' => 0, 'retweet_count' => 0, 'favorite_count' => 0, 'lang' => 'en', 'entities' => { 'user_mentions' => [], 'urls' => [], 'hashtags' => [], 'symbols' => [] }, 'views_count' => 5, 'bookmark_count' => 0 }
      ], 'next_cursor' => 'DAABCgABGHdoCZ9___IKAAIYJ36cuRtxDggAAwAAAAIAAA'
    }
  end

  let(:fetch_user_with_metrics_response_body) do
    {
      'id' => 1_691_930_809_756_991_488,
      'id_str' => '1691930809756991488',
      'name' => 'Topher',
      'screen_name' => 'TopherToy',
      'location' => '',
      'url' => nil,
      'description' => 'Revolutionize Your Twitter/X Strategy with Echosight https://t.co/uZpeIYc5Nq',
      'protected' => false,
      'verified' => false,
      'followers_count' => 3,
      'friends_count' => 16,
      'listed_count' => 0,
      'favourites_count' => 11,
      'statuses_count' => 15,
      'created_at' => '2023-08-16T21:52:25.000000Z',
      'profile_banner_url' => 'https://pbs.twimg.com/profile_banners/1691930809756991488/1702516482',
      'profile_image_url_https' => 'https://pbs.twimg.com/profile_images/1729697224278552576/pa9ZhTkQ_normal.jpg',
      'can_dm' => false
    }
  end
end
